<html>
    <head>
        <meta charset="utf-8">
        <title>videoviewer</title>

        <style>
            *{
                margin: 0px;
            }

            body {
                background-color: rgb(25, 25, 25);
                color: aliceblue;
            }

            .container {
                position: relative;
            }

            .container video {
                position: relative;
                width: 100%;
                height: auto;
	            vertical-align: middle;
                z-index: 0;
            }

            .overlay {
                position:absolute;
                left: 2%;
                top: 2%;
                z-index: 1;
            }

        </style>
    </head>
    <body>

        <div class="container">
            <video id="player" buffered> </video>

            <div class="overlay">
                <h1 id="label1"></h1>
            </div>
        </div>
        
        <script>

            const label1 = document.getElementById("label1");
            function setLabelText(msg) {
                label1.innerText = msg;
                label1.style.visibility="visible";
                setTimeout(() => {
                    label1.style.visibility="hidden";
                },500);
            }

            const smallmove = 1.0;
            const normalmove = 5.0;
            const bigmove = 30.0;

            const urlStr = window.location.href;
            const url = new URL(urlStr);
            const urlParams = url.searchParams;
            const path = urlParams.get('p');
            let player;

            function onKeydown(param)
            {
                console.log(param.key);
                console.log(param.ctrlKey);
                console.log(param.shiftKey);

                switch(param.key){
                    case ' ':
                        if(player.paused) {
                            player.play();
                            setLabelText("play");
                        }
                        else {
                            player.pause();
                            setLabelText("pause");
                        }
                        break;
                    case "ArrowRight":
                        {
                            let move;
                            let moveunit;

                            if(param.shiftKey)
                                moveunit = smallmove;
                            else if(param.ctrlKey)
                                moveunit = bigmove;
                            else
                                moveunit = normalmove;

                            move = player.currentTime + moveunit;

                            if(move >= player.duration) move = player.duration - 1.0;
                            player.currentTime = move;

                            setLabelText(`+ ${moveunit} s`);
                        }
                        break;
                    case "ArrowLeft":
                        {
                            let move;
                            let moveunit;

                            if(param.shiftKey)
                                moveunit = smallmove;
                            else if(param.ctrlKey)
                                moveunit = bigmove;
                            else
                                moveunit = normalmove;

                            move = player.currentTime - moveunit;

                            if(move < 0) move = 0;
                            player.currentTime = move;   

                            setLabelText(`- ${moveunit} s`);
                        }
                        break;
                }
            }

            if(path != null)
            {
                console.log(`path - ${path}`);
                player = document.getElementById("player");
                player.src = path;
                // player.playbackRate = 2.0;
                
                player.play();
                player.volume = 0.3;
                window.addEventListener("keydown", onKeydown);
            }
            else
            {
                console.log(`${path} is null`);
            }

        </script>

    </body>
</html>